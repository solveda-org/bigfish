<?xml version="1.0" encoding="UTF-8"?>
<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">

    <!-- CART SCREENS -->
    <screen name="eCommerceShowcart">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="cart" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="showCartFootprint" value="Y" />
                <set field="pageTitle" value="${uiLabelMap.ShoppingCartTitle}" />
                <set field="title" from-field="pageTitle" />

                <set field="formName" value="cartform" />
                <set field="updateCartAction" value="modifycart"/>
                <set field="shoppingCartSize" value="${groovy:org.ofbiz.order.shoppingcart.ShoppingCartEvents.getCartObject(request).size();}"/>
                <set field="addPromoCodeRequest" value="validateShowCartPromoCode"/>
                <set field="removePromoCodeRequest" value="removeShowCartPromoCode"/>
                <set field="backAction" value="main" />
                <set field="prevButtonDescription" value="${uiLabelMap.ContinueShoppingBtn}"/>
                <set field="prevButtonClass" value="${groovy:if(shoppingCartSize > 0)return 'standardBtn negative' else return 'standardBtn positive';}"/>
                <set field="doneAction" value="checkout" />
                <set field="nextButtonVisible" value="${groovy:if(shoppingCartSize > 0)return 'Y' else return 'N';}"/>
                <set field="nextButtonUrlDescription" value="${uiLabelMap.CheckoutBtn}"/>
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/cart/ShowCart.groovy" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="eCommerceShowcart" style="eCommerceShowcart">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_SHOPPING_CART" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="showCartDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_SHOPPING_CART" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>


    <!-- START ANON SINGLE PAGE CHECKOUT -->
    <screen name="anonSinglePageCheckout">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.SinglePageCheckoutTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="anonSinglePageCheckout" />
                <set field="formAction" value="anonSinglePageSubmitOrder" />
                <set field="isCheckoutPage" value="true" />

                <set field="shippingAttnName" value="${uiLabelMap.ShippingAddressDefaultNickNameLabel}" />
                <set field="isSameAsBilling" value="Y" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="${groovy:if(parameters.isPaymentProcessError == 'Y')return '' else return 'Y';}" />
                <set field="updateShippingOptionRequest" value="anonSinglePageUpdateShippingOption" />
                <set field="setShippingOptionRequest" value="anonSinglePageSetShippingOption" />
                <set field="addPromoCodeRequest" value="anonSinglePageValidatePromoCode"/>
                <set field="removePromoCodeRequest" value="anonSinglePageRemovePromoCode"/>
                <set field="removeStorePickupRequest" value="removeStorePickup" />
                <set field="dialogPurpose" value="storePickup_"/>
                <set field="shoppingCartSize" value="${groovy:org.ofbiz.order.shoppingcart.ShoppingCartEvents.getCartObject(request).size();}"/>
                <set field="useAvailability" value="Y" />
                <set field="loadPca" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="submitOrderAction" value="anonSinglePageSubmitOrder"/>
                <set field="payPalAction" value="anonSinglePageSetPayPalCheckout"/>
                <set field="ebsAction" value="anonSinglePageEBSCheckout"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <condition>
                                <if-compare operator="greater" value="0" field="shoppingCartSize"/>
                            </condition>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                            </actions>
                            <widgets>
                                <container id="anonSinglePageCheckout" style="anonSinglePageCheckout">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="anonOnePageCheckoutDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="commonDialog">
                                                        <include-screen name="storePickupDialog" location="component://osafe/widget/DialogScreens.xml" />
                                                </html-template-decorator-section>
                                                </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                            <fail-widgets>
                                <container style="displayBox">
                                    <label style="instructions" text="${uiLabelMap.YourShoppingCartIsEmptyInfo}"/>
                                </container>
                            </fail-widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="anonSinglePagePayPalOrderSummary">
        <section>
            <actions>
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="submitOrderAction" value="anonSinglePagePayPalSubmitOrder"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="anonSinglePagePayPalOrderSummary" style="anonSinglePagePayPalOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="anonPaypalOrderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
<!-- END ANON SINGLE PAGE CHECKOUT -->

<!-- START RETURNING SINGLE PAGE CHECKOUT -->
    <screen name="singlePageCheckout">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.SinglePageCheckoutTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="anonSinglePageCheckout" />
                <set field="formAction" value="singlePageSubmitOrder" />
                <set field="showAddressSelection" value="Y" />
                <set field="addAddressAction" value="singlePageNewCheckoutAddress"/>
                <set field="isCheckoutPage" value="true" />

                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="${groovy:if(parameters.isPaymentProcessError == 'Y')return '' else return 'Y';}" />
                <set field="updateShippingOptionRequest" value="singlePageUpdateShippingOption" />
                <set field="setShippingOptionRequest" value="singlePageSetShippingOption" />
                <set field="addPromoCodeRequest" value="singlePageValidatePromoCode"/>
                <set field="removePromoCodeRequest" value="singlePageRemovePromoCode"/>
                <set field="removeStorePickupRequest" value="removeStorePickup" />
                <set field="dialogPurpose" value="storePickup_"/>
                <set field="shoppingCartSize" value="${groovy:org.ofbiz.order.shoppingcart.ShoppingCartEvents.getCartObject(request).size();}"/>
                <set field="useAvailability" value="Y" />
                <set field="loadPca" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="submitOrderAction" value="singlePageSubmitOrder"/>
                <set field="payPalAction" value="singlePageSetPayPalCheckout"/>
                <set field="ebsAction" value="singlePageEBSCheckout"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <condition>
                                <if-compare operator="greater" value="0" field="shoppingCartSize"/>
                            </condition>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                            </actions>
                            <widgets>
                                <container id="singlePageCheckout" style="singlePageCheckout">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="onePageCheckoutDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="commonDialog">
                                                        <include-screen name="storePickupDialog" location="component://osafe/widget/DialogScreens.xml" />
                                                </html-template-decorator-section>
                                                </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                            <fail-widgets>
                                <container style="displayBox">
                                    <label style="instructions" text="${uiLabelMap.YourShoppingCartIsEmptyInfo}"/>
                                </container>
                            </fail-widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="singlePagePayPalOrderSummary">
        <section>
            <actions>
                <set field="screenMessages" value="Y" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="submitOrderAction" value="singlePageProcessCartAttribute"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="singlePagePayPalOrderSummary" style="singlePagePayPalOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="payPalOrderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="singlePageNewCheckoutAddress">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${groovy:if(parameters.contactMechPurposeTypeId.equals('BILLING_LOCATION'))return (uiLabelMap.BillingAddressTitle); else return (uiLabelMap.ShippingAddressTitle);}"/>
                <set field="formName" value="checkoutInfoForm" />
                <set field="formAction" value="singlePageValidateCheckoutAddress" />
                <set field="donePage" value="singlePageCheckout" />

                <set field="title" from-field="pageTitle" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="nextButtonVisible" value="N" />
                <set field="loadPca" value="Y" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                            </actions>
                            <widgets>
                                <container id="singlePageNewCheckoutAddress" style="singlePageNewCheckoutAddress">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="singlePageNewCustomerAddress" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="singlePageNewCustomerAddress">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="contactMechEntryForm" location="component://osafe/widget/EntryScreens.xml" />
                <include-screen name="formEntryContinueBackButton" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>
<!-- RETURNING SINGLE PAGE CHECKOUT -->

  <!-- START RETURNING MULTI PAGE CHECK OUT SCREENS -->

    <screen name="multiPageCustomerAddress">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="shipping" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="showCartFootprint" value="Y" />
                <set field="pageTitle" value="${uiLabelMap.CustomerAddressTitle}" />
                <set field="title" from-field="pageTitle" />

                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="shippingaddress" />
                <set field="showAddressSelection" value="Y" />

                <set field="prevButtonUrl" value="eCommerceShowcart" />
                <set field="doneAction" value="multiPageUpdateCustomerAddress"/>
                <set field="addAddressAction" value="multiPageNewCheckoutAddress"/>
                <set field="loadPca" value="Y" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                            </actions>
                            <widgets>
                                <container id="multiPageCustomerAddress" style="multiPageCustomerAddress">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_SHIPPING_ADDRESS" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="shippingAddressDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_SHIPPING_ADDRESS" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="multiPageNewCheckoutAddress">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="shipping" />
                <set field="pageTitle" value="${groovy:if(parameters.contactMechPurposeTypeId.equals('BILLING_LOCATION'))return (uiLabelMap.BillingAddressTitle); else return (uiLabelMap.ShippingAddressTitle);}"/>
                <set field="formName" value="checkoutInfoForm" />
                <set field="formAction" value="multiPageValidateCheckoutAddress" />
                <set field="donePage" value="multiPageCustomerAddress" />
                <set field="checkoutPage" value="shippingaddress" />

                <set field="title" from-field="pageTitle" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="nextButtonVisible" value="N" />
                <set field="loadPca" value="Y" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                            </actions>
                            <widgets>
                                <container id="multiPageNewCheckoutAddress" style="multiPageNewCheckoutAddress">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="multiPageNewCustomerAddress" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
   
    <screen name="multiPageShippingOptions">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="shippingMethod" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="pageTitle" value="${uiLabelMap.ShippingOptionsTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="shippingoptions" />

                <set field="defaultShippingMethod" value="GROUND@UPS" />
                <set field="storePickupButtonVisible" value="Y" />
                <set field="storePickupUrl" value="storePickup" />
                <set field="storePickupClass" value="standardBtn positive" />
                <set field="updateShippingOptionRequest" value="multiPageUpdateShippingOption" />
                <set field="removeStorePickupRequest" value="removeStorePickup" />
                <set field="dialogPurpose" value="storePickup_"/>
                <set field="storePickupDescription" value="${uiLabelMap.PickupInStoreBtn}"/>
                <set field="doneAction" value="multiPageCheckoutOptions"/>
                <set field="backAction" value="multiPageCustomerAddress"/>

            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageShippingOptions" style="multiPageShippingOptions">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_SHIPPING_METHOD" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="shippingOptionsDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_SHIPPING_METHOD" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="commonDialog">
                                                    <include-screen name="storePickupDialog" location="component://osafe/widget/DialogScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="multiPageOrderSummary">
        <section>
            <actions>
                <set field="selectedStep" value="payment" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="${groovy:if(parameters.isPaymentProcessError == 'Y')return '' else return 'Y';}" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />
                <set field="addPromoCodeRequest" value="validateCartPromoCode"/>
                <set field="removePromoCodeRequest" value="removeCartPromoCode"/>

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="submitOrderAction" value="multiPageSubmitOrder"/>
                <set field="backAction" value="multiPageShippingOptions"/>
                <set field="payPalAction" value="setPayPalCheckout"/>
                <set field="ebsAction" value="multiPageEBSCheckout"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageOrderSummary" style="multiPageOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="orderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="multiPagePayPalOrderSummary">
        <section>
            <actions>
                <set field="selectedStep" value="payment" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="submitOrderAction" value="multiPageProcessCartAttribute"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageOrderSummary" style="multiPageOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="payPalOrderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
<!-- END RETURNING MULTI PAGE CHECK OUT SCREENS -->
    <screen name="eCommerceOrderComplete">
        <section>
            <actions>
                <set field="selectedStep" value="confirmation" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderConfirmationTitle}" />
                <set field="title" from-field="pageTitle" />

                <!-- For the Google Analytics to know the order was generated -->
                <set field="orderConfirmed" value="Y" />

                <!-- This set has to be before the groovy invocation -->
                <set field="showThankYouStatus" value="Y" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderConfirm.groovy" />

                <set field="showCartFootprint" value="Y" />
                <set field="useAvailability" value="N" />
                <set field="prevButtonVisible" value="N" />

                <set field="nextButtonUrl" value="main" />
                <set field="nextButtonDescription" value="${uiLabelMap.ContinueShoppingBtn}" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageOrderConfirm" style="multiPageOrderConfirm">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_CONFIRM" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="orderConfirmDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_CONFIRM" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>


<!-- START ANON MULTI PAGE CHECK OUT SCREENS -->

    <screen name="anonMultiPageCustomerAddress">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="shipping" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="showCartFootprint" value="Y" />
                <set field="pageTitle" value="${uiLabelMap.AnonCustomerInformationTitle}" />
                <set field="title" from-field="pageTitle" />

                <set field="shippingAttnName" value="${uiLabelMap.ShippingAddressDefaultNickNameLabel}" />
                <set field="isSameAsBilling" value="Y" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="shippingaddress" />
                <set field="isCheckoutPage" value="true" />

                <set field="prevButtonUrl" value="eCommerceShowcart" />
                <set field="doneAction" value="annonMultiPageCreateCustomer"/>
                <set field="loadPca" value="Y" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <actions>
                                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCountry.groovy" />
                            </actions>
                            <widgets>
                                <container id="multiPageCustomerAddress" style="multiPageCustomerAddress">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_SHIPPING_ADDRESS" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="anonShippingAddressDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_SHIPPING_ADDRESS" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="capturePlusJs">
                                                    <include-screen name="capturePlusJs" location="component://osafe/widget/EntryScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="anonMultiPageShippingOptions">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="selectedStep" value="shippingMethod" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <set field="pageTitle" value="${uiLabelMap.ShippingOptionsTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="shippingoptions" />

                <set field="defaultShippingMethod" value="GROUND@UPS" />
                <set field="storePickupButtonVisible" value="Y" />
                <set field="storePickupUrl" value="storePickup" />
                <set field="storePickupClass" value="standardBtn positive" />
                <set field="updateShippingOptionRequest" value="multiPageUpdateShippingOption" />
                <set field="removeStorePickupRequest" value="removeStorePickup" />
                <set field="dialogPurpose" value="storePickup_"/>
                <set field="storePickupDescription" value="${uiLabelMap.PickupInStoreBtn}"/>
                <set field="doneAction" value="anonMultiPageSetShippingOption"/>
                <set field="backAction" value="anonMultiPageCustomerAddress"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageShippingOptions" style="multiPageShippingOptions">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_SHIPPING_METHOD" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="shippingOptionsDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_SHIPPING_METHOD" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="commonDialog">
                                                    <include-screen name="storePickupDialog" location="component://osafe/widget/DialogScreens.xml" />
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="anonMultiPageOrderSummary">
        <section>
            <actions>
                <set field="selectedStep" value="payment" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="${groovy:if(parameters.isPaymentProcessError == 'Y')return '' else return 'Y';}" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />
                <set field="addPromoCodeRequest" value="anonMultiPageValidateCartPromoCode"/>
                <set field="removePromoCodeRequest" value="anonMultiPageRemoveCartPromoCode"/>

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="submitOrderAction" value="anonMultiPageSubmitOrder"/>
                <set field="backAction" value="anonMultiPageShippingOptions"/>
                <set field="payPalAction" value="anonMultiPageSetPayPalCheckout"/>
                <set field="ebsAction" value="anonMultiPageEBSCheckout"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageOrderSummary" style="multiPageOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="anonOrderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>

    <screen name="anonMultiPagePayPalOrderSummary">
        <section>
            <actions>
                <set field="selectedStep" value="payment" />
                <set field="screenMessages" value="Y" />
                <set field="fieldLevelErrors" value="Y" />
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="pageTitle" value="${uiLabelMap.OrderSummaryTitle}" />
                <set field="title" from-field="pageTitle" />
                <set field="formName" value="checkoutInfoForm" />
                <set field="checkoutPage" value="payment" />

                <set field="parameters.formNameValue" value="orderreview" global="true" />

                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceCustomerAddress.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutPayment.groovy" />
                <script location="component://order/webapp/ordermgr/WEB-INF/actions/entry/StorePaymentOptions.groovy" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/customer/EditPaymentMethod.groovy" />

                <!-- Used to be in eCommerceCheckoutReview -->
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/common/eCommerceOrderSummary.groovy" />

                <set field="useAvailability" value="Y" />
                <set field="nextButtonVisible" value="N" />
                <set field="submitOrderButtonVisible" value="Y" />
                <set field="prevButtonVisible" value="N" />
                <set field="submitOrderAction" value="anonMultiPagePayPalSubmitOrder"/>
            </actions>
            <widgets>
                <decorator-screen name="${parameters.eCommerceDecoratorName}" location="${parameters.eCommerceDecoratorLocation}">
                    <decorator-section name="title">
                        <include-screen name="pageTitle" location="component://osafe/widget/EcommerceScreens.xml"/>
                    </decorator-section>
                    <decorator-section name="body">
                        <section>
                            <widgets>
                                <container id="multiPageOrderSummary" style="multiPageOrderSummary">
                                    <platform-specific>
                                        <html>
                                            <html-template-decorator location="component://osafe/webapp/osafe/templates/commonCheckout.ftl">
                                                <html-template-decorator-section name="entryFormJS">
                                                    <include-screen name="entryFormJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="checkoutJS">
                                                    <include-screen name="checkoutJS"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageMessages">
                                                    <include-screen name="PageMessages" location="${parameters.mainDecoratorLocation}" />
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartFootprint">
                                                    <include-screen name="eCommerceCartFootprint"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageTopContent">
                                                    <include-screen name="PTS_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="cartBody">
                                                    <include-screen name="anonPaypalOrderSummaryDivSequence" location="component://osafe/widget/EcommerceDivScreens.xml"/>
                                                </html-template-decorator-section>
                                                <html-template-decorator-section name="pageEndContent">
                                                    <include-screen name="PES_ORDER_SUMMARY" location="component://osafe/widget/EcommerceContentScreens.xml"/>
                                                </html-template-decorator-section>
                                            </html-template-decorator>
                                        </html>
                                    </platform-specific>
                                </container>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
<!-- END ANON MULTI PAGE CHECK OUT SCREENS -->


<!-- GENERAL CHECKOUT SCREENS -->
    <!-- SHOW CART -->
    <screen name="showCartOrderItems">
        <section>
            <actions>
            </actions>
            <widgets>
                  <platform-specific>
                       <html>
                           <html-template location="component://osafe/webapp/osafe/common/cart/showCartItems.ftl" />
                       </html>
                   </platform-specific>
            </widgets>
        </section>
    </screen>
    
    <!-- CHECKOUT INCLUDES -->
    <screen name="eCommerceEnterPromoCode">
        <section>
            <widgets>
                <container id="eCommerceEnterPromoCode">
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceEnterPromoCode.ftl" />
                    </html>
                </platform-specific>
                </container>
            </widgets>
        </section>
    </screen>

    <screen name="eCommerceEnteredPromoCode">
        <section>
            <widgets>
                <container id="eCommerceEnteredPromoCode">
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceEnteredPromoCode.ftl" />
                    </html>
                </platform-specific>
                </container>
            </widgets>
        </section>
    </screen>

    <screen name="entryFormJS">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                      <html-template location="component://osafe/webapp/osafe/common/entry/js/formEntryJS.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="checkoutJS">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                      <html-template location="component://osafe/webapp/osafe/common/entry/js/checkoutJS.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="cartOrderItems">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/orderItems.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="cartBillingAddress">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/cart/cartBillingAddress.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="cartShippingAddress">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/cart/cartShippingAddress.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="paymentInformation">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/paymentInformation.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="orderConfirmThankyou">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/cart/orderConfirmThankyou.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <!-- SINGLE-PAGE INCLUDES -->
    <screen name="singlePageAboutYou">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="aboutYouEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="singlePageBillingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.BillingAddressHeadingInfo}"/>
            </actions>
            <widgets>
                <include-screen name="addressBillingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="singlePageShippingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.ShippingAddressHeadingInfo}"/>
                <set field="isShipping" value="N"/>
                <set field="showAttnName" value="N"/>
            </actions>
            <widgets>
                <include-screen name="addressShippingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="singlePagePromoCode">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="eCommerceEnterPromoCode"/>
            </widgets>
        </section>
    </screen>

    <screen name="singlePageShippingOptions">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="dialogPurpose" value="storePickup_"/>
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/setup/EcommerceSetup.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutShippingOptions.groovy" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutShippingOptions.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="singlePageStorePickup">
        <section>
            <actions>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutStorePickupOption.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="singlePageOrderDetail">
        <section>
            <actions>
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/setup/EcommerceSetup.groovy"/>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <set field="useAvailability" value="Y" />
            </actions>
            <widgets>
                    <include-screen name="orderItems" location="component://osafe/widget/EcommerceScreens.xml"/>
            </widgets>
        </section>
    </screen>
    <screen name="singlePageOrderPayment">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceOrderPaymentMethods.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="singlePageCreateAccount">
        <section>
            <actions>
                <set field="REG_PWD_MIN_CHAR" from-field="REG_PWD_MIN_CHAR" type="Integer" />
                <set field="REG_PWD_MIN_NUM" from-field="REG_PWD_MIN_NUM" type="Integer" />
                <set field="REG_PWD_MIN_UPPER" from-field="REG_PWD_MIN_UPPER" type="Integer" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                      <html-template location="component://osafe/webapp/osafe/common/entry/createAccountEntry.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

<!--  ANON SINGLE-PAGE-->
    <screen name="anonSinglePageAboutYou">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="aboutYouEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePageBillingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.BillingAddressHeadingInfo}"/>
            </actions>
            <widgets>
                <include-screen name="addressBillingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePageShippingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.ShippingAddressHeadingInfo}"/>
                <set field="isShipping" value="Y"/>
            </actions>
            <widgets>
                <include-screen name="addressShippingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePagePromoCode">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="eCommerceEnterPromoCode"/>
            </widgets>
        </section>
    </screen>
    
    <screen name="anonSinglePageShippingOptions">
        <section>
            <actions>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <set field="dialogPurpose" value="storePickup_"/>
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/setup/EcommerceSetup.groovy" />
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutShippingOptions.groovy" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutShippingOptions.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePageStorePickup">
        <section>
            <actions>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutStorePickupOption.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="anonSinglePageOrderDetail">
        <section>
            <actions>
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/setup/EcommerceSetup.groovy"/>
                <property-map resource="OSafeUiLabels" map-name="uiLabelMap" global="true" />
                <script location="component://ecommerce/webapp/ecommerce/WEB-INF/actions/order/CheckoutReview.groovy" />
                <set field="useAvailability" value="Y" />
            </actions>
            <widgets>
                    <include-screen name="orderItems" location="component://osafe/widget/EcommerceScreens.xml"/>
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePageOrderPayment">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceOrderPaymentMethods.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="anonSinglePageCreateAccount">
        <section>
            <actions>
                <set field="REG_PWD_MIN_CHAR" from-field="REG_PWD_MIN_CHAR" type="Integer" />
                <set field="REG_PWD_MIN_NUM" from-field="REG_PWD_MIN_NUM" type="Integer" />
                <set field="REG_PWD_MIN_UPPER" from-field="REG_PWD_MIN_UPPER" type="Integer" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                      <html-template location="component://osafe/webapp/osafe/common/entry/createAccountEntry.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <!-- MULTI-PAGE INCLUDES -->
    <screen name="eCommerceCartFootprint">
        <section>
            <widgets>
                <container id="eCommerceCartFootprintContainer">
                    <platform-specific>
                        <html>
                            <html-template location="component://osafe/webapp/osafe/common/eCommerceCartFootprint.ftl" />
                        </html>
                    </platform-specific>
                </container>
            </widgets>
        </section>
    </screen>

    <screen name="multiPageBillingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.BillingAddressHeadingInfo}"/>
            </actions>
            <widgets>
                <include-screen name="addressBillingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>
    <screen name="anonMultiPageBillingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.BillingAddressHeadingInfo}"/>
            </actions>
            <widgets>
                <include-screen name="anonAddressBillingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>
    

    <screen name="multiPageShippingAddress">
        <section>
            <actions>
                <set field="addressEntryInfo" value="${uiLabelMap.ShippingAddressHeadingInfo}"/>
            </actions>
            <widgets>
                <include-screen name="addressShippingEntryForm" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>
    <screen name="multiPageNewCustomerAddress">
        <section>
            <actions>
            </actions>
            <widgets>
                <include-screen name="contactMechEntryForm" location="component://osafe/widget/EntryScreens.xml" />
                <include-screen name="formEntryContinueBackButton" location="component://osafe/widget/EntryScreens.xml" />
            </widgets>
        </section>
    </screen>
    
    <screen name="multiPageShippingOptionList">
        <section>
            <actions>
                <script location="component://osafe/webapp/osafe/WEB-INF/actions/checkout/eCommerceCheckoutShippingOptions.groovy" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutShippingOptions.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="multiPageStorePickup">
        <section>
            <actions>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCheckoutStorePickupOption.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <screen name="multiPageOrderPayment">
        <section>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceOrderPaymentMethods.ftl" />
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="multiPageCreateAccount">
        <section>
            <actions>
                <set field="REG_PWD_MIN_CHAR" from-field="REG_PWD_MIN_CHAR" type="Integer" />
                <set field="REG_PWD_MIN_NUM" from-field="REG_PWD_MIN_NUM" type="Integer" />
                <set field="REG_PWD_MIN_UPPER" from-field="REG_PWD_MIN_UPPER" type="Integer" />
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                      <html-template location="component://osafe/webapp/osafe/common/entry/createAccountEntry.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

        <!-- These variables control the previous and next buttons. You may add 
            these variables to your parent screen definition. By default buttons will 
            be visible and get default values from the eCommerceCartButtons.ftl <set 
            field="prevButtonVisible" value="N" /> <set field="prevButtonUrl" value="" 
            /> <set field="prevButtonClass" value="" /> <set field="prevButtonDescription" 
            value="" /> <set field="nextButtonVisible" value="N" /> <set field="nextButtonUrl" 
            value="" /> <set field="nextButtonClass" value="" /> <set field="nextButtonDescription" 
            value="" /> 
            NO LONGER USED - LS 07/02/12
    <screen name="eCommerceCartButtons">
        <section>
            <widgets>
                <container id="eCommerceCartButtons">
                <platform-specific>
                    <html>
                        <html-template location="component://osafe/webapp/osafe/common/eCommerceCartButtons.ftl" />
                    </html>
                </platform-specific>
                </container>
            </widgets>
        </section>
    </screen>
    -->
</screens>